#include <Arduino.h>

// Pins for P10 1/4 scan panel
#define R1   2
#define G1   3
#define B1   4
#define R2   5
#define G2   6
#define B2   7
#define ROW_A A0
#define ROW_B A1
#define ROW_C A2
#define OE   9
#define LAT  10
#define CLK  11

void setup() {
  pinMode(R1, OUTPUT); pinMode(G1, OUTPUT); pinMode(B1, OUTPUT);
  pinMode(R2, OUTPUT); pinMode(G2, OUTPUT); pinMode(B2, OUTPUT);
  pinMode(ROW_A, OUTPUT); pinMode(ROW_B, OUTPUT); pinMode(ROW_C, OUTPUT);
  pinMode(OE, OUTPUT); pinMode(LAT, OUTPUT); pinMode(CLK, OUTPUT);

  digitalWrite(OE, HIGH); // disable output initially
}

void loop() {
  clearRow();          // Clear all LEDs first
  setRow(0);           // Select row 0
  setPixel(0, 'B');    // Turn on first column red
  latchRow();          // Latch data
  enableOutput();      // Enable the row
  delay(1000);         // Keep it on for 1 second
}

// Functions
void clearRow() {
  digitalWrite(OE, HIGH);
  for (int i = 0; i < 32; i++) {
    digitalWrite(R1, LOW); digitalWrite(G1, LOW); digitalWrite(B1, LOW);
    digitalWrite(R2, LOW); digitalWrite(G2, LOW); digitalWrite(B2, LOW);
    pulseClock();
  }
}

void setRow(int row) {
  digitalWrite(ROW_A, row & 0x01);
  digitalWrite(ROW_B, (row >> 1) & 0x01);
  digitalWrite(ROW_C, (row >> 2) & 0x01);
}

void setPixel(int col, char color) {
  for (int i = 0; i < 32; i++) {
    if (i == col) {
      digitalWrite(R1, color=='R'); 
      digitalWrite(G1, color=='G'); 
      digitalWrite(B1, color=='B');
    } else {
      digitalWrite(R1, LOW); digitalWrite(G1, LOW); digitalWrite(B1, LOW);
    }
    digitalWrite(R2, LOW); digitalWrite(G2, LOW); digitalWrite(B2, LOW);
    pulseClock();
  }
}

void pulseClock() {
  digitalWrite(CLK, HIGH);
  digitalWrite(CLK, LOW);
}

void latchRow() {
  digitalWrite(LAT, HIGH);
  digitalWrite(LAT, LOW);
}

void enableOutput() {
  digitalWrite(OE, LOW);
}  this glows 
